generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id       String  @id @default(uuid())
  email    String  @unique
  username String  @unique
  imageUrl String?
  Trip     Trip[]

  provider Provider @default(Credentials)
  role     Role     @default(USER)

  lastSignInAt DateTime?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model Trip {
  id      String @id @default(uuid())
  owner   User   @relation(fields: [ownerId], references: [id])
  ownerId String

  name      String
  startDate DateTime
  endDate   DateTime
  days      Int
  position  Int
  events    Event[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Event {
  id     String @id @default(uuid())
  Trip   Trip   @relation(fields: [tripId], references: [id])
  tripId String

  name        String
  date        DateTime
  position    Int
  address     String?
  cost        Float?
  phoneNumber String?
  website     String?
  type        EventType?

  googlePlace   GooglePlace? @relation(fields: [googlePlaceId], references: [placeId])
  googlePlaceId String?
}

model GooglePlace {
  placeId             String            @id
  photoReference      String?           @unique
  url                 String?           @unique
  type                String?
  types               GooglePlaceType[]
  geometry            Json?
  currentOpeningHours Json?

  priceLevel Int?
  rating     Float?
  utcOffset  Float?
  vicinity   String?

  curbsidePickup               Boolean?
  delivery                     Boolean?
  dineIn                       Boolean?
  reservable                   Boolean?
  servesBeer                   Boolean?
  servesBreakfast              Boolean?
  servesBrunch                 Boolean?
  servesDinner                 Boolean?
  servesLunch                  Boolean?
  servesVegetarianFood         Boolean?
  servesWine                   Boolean?
  takeout                      Boolean?
  wheelchairAccessibleEntrance Boolean?

  Event Event[]
}

model GooglePlaceType {
  typeName String        @id
  places   GooglePlace[]
}

// Enums
enum Role {
  ADMIN
  TESTER
  PREMIUM
  USER
}

enum Provider {
  Credentials
  Google
}

enum EventType {
  DEFAULT
  FOOD
  ACCOMODATION
  TRANSPORT
}
